#!/usr/bin/env php
<?php

require 'vendor\autoload.php';

use PhpDto\Cli\Handler;
use PhpDto\Services\Maker;
use PhpDto\Services\DtoPattern;
use PhpDto\Services\DtoConfig;

try
{
    (new DtoConfig())->setVariables( getcwd().'//phpdto.json' );

	$handler = new Handler();
	$handler->handleArgs( $_SERVER['argv'] );

	$dtoPattern = new DtoPattern();
	$dtoPattern->setPattern( $handler );

	$maker = new Maker( $dtoPattern->getPattern(), $handler );

	$maker->makeDTO();

	if( $handler->isGenerateUnitTest() )
	{
		$maker->makeUnitTest();
	}
}
catch ( \Exception $exception )
{
	echo $exception->getMessage();
}
